# LCD1602-HD44780

![](/docs/lcd1602.png)

Это библиотека на AVR-ассемблере для взаимодействия с ЖК-дисплеем LCD1602 на базе контроллера HD44780.

Она используется в проекте "Hardware Calculator From Scratch", который можно найти [здесь](https://github.com/igor-240340/HardwareCalculatorFromScratch).

## Возможности

- **Управление курсором**: Перемещение курсора в начало первой или второй строки либо в конец первой строки. Скрытие или отображение курсора с миганием или без.
- **Вывод символов**: Печать одиночных символов.
- **Вывод строк**: Вывод строк, хранящихся в SRAM.
- **Поддержка 8-битного режима**: Работает исключительно в 8-битном режиме передачи данных.
- **Синхронизация по busy-флагу**: Синхронно ожидает готовности контроллера чтением busy-флага.

## Конфигурация по умолчанию

- **Линия управления**: `PORTC`.
- **Линия данных/инструкций**: `PORTB`.
- **Busy-флаг**: `PORTB`, седьмой бит.

## Обзор функций

### Управление курсором

- **Перемещение в начало/конец строки**:
  - `CURSL1BEG`: Переместить курсор в начало первой строки.
  - `CURSL2BEG`: Переместить курсор в начало второй строки.
  - `CURSL1END`: Переместить курсор в конец первой строки (последний видимый символ).
- **Видимость курсора**:
  - `DSBLCURS`: Скрыть курсор.
  - `ENBLCURS`: Показать мигающий курсор.

### Управление дисплеем

- **Очистка дисплея**: 
  - `CLEARLCD`: Очистить дисплей и вернуть курсор в начало первой строки.
- **Сдвиг дисплея**:
  - `SHFTLFT`: Сдвинуть дисплей влево на одну позицию.
  - `SHFTRGHT`: Сдвинуть дисплей вправо на одну позицию.

### Запись данных

- **Вывод символа**: 
  - `PRNTCHR`: Вывести одиночный символ, хранящийся в регистре `CHAR`.
- **Вывод строки**: 
  - `PRNTSTR`: Вывести строку, хранящуюся в SRAM, адрес которой находится в паре регистров `XH:XL`.

### Ожидание готовности LCD-дисплея

- **Ожидание busy-флага**:
  - `WAITBUSY`: Ждать, пока busy-флаг не будет сброшен, сигнализируя готовность LCD к следующей команде.

## Использование

### Инициализация

Для инициализации LCD вызовите `INITLCD` в начале программы:

```assembly
RCALL INITLCD
```

### Вывод текста

Чтобы отобразить текст, загрузите адрес строки в `XH:XL` и вызовите `PRNTSTR`:

```assembly
LDI XH, HIGH(STRING_ADDRESS)
LDI XL, LOW(STRING_ADDRESS)
RCALL PRNTSTR
```

### Вывод одиночных символов

Чтобы напечатать символ, загрузите его в регистр `CHAR` и вызовите `PRNTCHR`:

```assembly
LDI R16, 'A'   ; Загрузить символ 'A' в регистр R16.
MOV CHAR, R16  ; Скопировать символ в регистр CHAR.
RCALL PRNTCHR  ; Напечатать символ.
```

### Управление курсором

Для перемещения курсора или изменения его видимости используйте соответствующие функции:

```assembly
RCALL CURSL1BEG  ; Переместить курсор в начало первой строки.
RCALL ENBLCURS   ; Включить мигающий курсор.
```

### Очистка дисплея

Очистить дисплей и сбросить позицию курсора:

```assembly
RCALL CLEARLCD
```